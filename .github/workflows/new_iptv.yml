name: ğŸ¬ IPTV Auto Update
on:
  schedule:
    - cron: '0 13,19 * * *'
  workflow_dispatch:

jobs:
  update:
    runs-on: ubuntu-latest
    
    steps:
    # âœ… 1. æ£€å‡ºä»£ç 
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4
      
    # âœ… 2. è®¾ç½® Python
    - name: ğŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    # âœ… 3. å®‰è£…ä¾èµ–ï¼ˆä¿®å¤æ ¸å¿ƒé—®é¢˜ï¼‰
    - name: ğŸ“¦ Install Python Dependencies
      run: |
        pip install --upgrade pip
        pip install requests schedule psutil
        
    # âœ… 4. å®‰è£… FFmpeg
    - name: ğŸ”§ Install FFmpeg
      run: sudo apt-get update && sudo apt-get install -y ffmpeg
      
    # âœ… 5. è¿è¡Œè„šæœ¬
    - name: ğŸš€ Run IPTV Scraper
      run: python new_iptv_scraper.py --once
      
    # âœ… 6. æäº¤ç»“æœ
    - name: ğŸ“¤ Commit & Push
      run: |
        git config user.name "IPTV-Bot"
        git config user.email "bot@github.com"
        git add .
        git commit -m "ğŸ‰ IPTV Update $(date)" || echo "No changes"
        git push
