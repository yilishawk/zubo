import asyncio
import aiohttp
import re
import datetime
import requests
import os
import threading

# ===================== é…ç½® =====================
urls = [
        "http://1.192.12.1:9901",
        "http://1.192.248.1:9901",
        "http://1.194.52.1:10086",
        "http://1.195.111.1:11190",
        "http://1.195.131.1:9901",
        "http://1.195.62.1:9901",
        "http://1.196.192.1:9901",
        "http://1.196.55.1:9901",
        "http://1.197.153.1:9901",
        "http://1.197.203.1:9901",
        "http://1.198.30.1:9901",
        "http://1.198.67.1:9901",
        "http://1.199.234.1:9901",
        "http://1.199.235.1:9901",
        "http://101.65.32.1:9901",
        "http://101.66.199.1:9901",
        "http://101.74.28.1:9901",
        "http://103.39.222.1:9999",
        "http://106.115.121.1:9901",
        "http://106.46.147.1:10443",
        "http://106.46.34.1:9901",
        "http://106.55.164.1:9901",
        "http://110.189.180.1:9901",
        "http://110.52.99.1:9901",
        "http://111.225.114.1:808",
        "http://111.225.115.1:9901",
        "http://111.33.89.1:9901",
        "http://111.59.63.1:9901",
        "http://111.74.155.1:9901",
        "http://111.78.22.1:9901",
        "http://111.78.34.1:9901",
        "http://111.8.224.1:8085",
        "http://111.8.242.1:8085",
        "http://112.123.218.1:9901",
        "http://112.123.219.1:9901",
        "http://112.132.160.1:9901",
        "http://112.193.114.1:9901",
        "http://112.193.42.1:9901",
        "http://112.194.128.1:9901",
        "http://112.194.140.1:9901",
        "http://112.194.206.1:9901",
        "http://112.5.89.1:9900",
        "http://112.5.89.1:9901",
        "http://112.6.117.1:9901",
        "http://112.99.200.1:9901",
        "http://113.100.72.1:9901",
        "http://113.111.104.1:9901",
        "http://113.116.145.1:8883",
        "http://113.116.56.1:8883",
        "http://113.195.4.1:9901",
        "http://113.195.45.1:9901",
        "http://113.195.7.1:9901",
        "http://113.195.8.1:9901",
        "http://113.220.232.1:9999",
        "http://113.220.233.1:9999",
        "http://113.220.234.1:9999",
        "http://113.220.235.1:9999",
        "http://113.223.12.1:9998",
        "http://113.236.30.1:9901",
        "http://113.245.217.1:9901",
        "http://113.245.218.1:9901",
        "http://115.207.24.1:9901",
        "http://115.215.143.1:9901",
        "http://115.220.17.1:9901",
        "http://115.224.206.1:9901",
        "http://115.225.233.1:9901",
        "http://115.236.171.1:9901",
        "http://115.236.83.1:1111",
        "http://115.48.160.1:9901",
        "http://115.48.161.1:9901",
        "http://115.48.22.1:9901",
        "http://116.117.107.1:8096",
        "http://116.128.224.1:9901",
        "http://116.128.242.1:9901",
        "http://116.167.111.1:9901",
        "http://116.167.76.1:9901",
        "http://116.167.79.1:9901",
        "http://116.227.232.1:7777",
        "http://116.233.34.1:7777",
        "http://116.30.121.1:8883",
        "http://116.31.165.1:280",
        "http://116.31.165.1:3079",
        "http://118.248.167.1:8088",
        "http://118.248.168.1:8088",
        "http://118.248.169.1:8088",
        "http://118.248.170.1:8088",
        "http://118.248.216.1:8088",
        "http://118.253.0.1:2023",
        "http://118.72.69.1:888",
        "http://118.81.106.1:9999",
        "http://118.81.107.1:9999",
        "http://119.119.77.1:9901",
        "http://119.120.196.1:9999",
        "http://119.142.76.1:9901",
        "http://119.142.77.1:9901",
        "http://119.163.199.1:9901",
        "http://119.163.228.1:9901",
        "http://119.163.56.1:9901",
        "http://119.163.57.1:9901",
        "http://119.163.60.1:9901",
        "http://119.163.61.1:9901",
        "http://119.163.63.1:9901",
        "http://119.164.81.1:9901",
        "http://119.62.28.1:9901",
        "http://119.62.36.1:9901",
        "http://119.62.80.1:9901",
        "http://120.0.52.1:8086",
        "http://120.0.8.1:8086",
        "http://120.197.43.1:9901",
        "http://120.198.96.1:9901",
        "http://120.198.99.1:9901",
        "http://120.211.129.1:9901",
        "http://120.224.178.1:9901",
        "http://120.224.23.1:9901",
        "http://120.238.150.1:9901",
        "http://120.238.85.1:9901",
        "http://121.19.134.1:808",
        "http://121.232.178.1:5000",
        "http://121.232.187.1:6000",
        "http://121.238.176.1:9901",
        "http://121.24.98.1:9901",
        "http://121.33.239.1:9901",
        "http://122.4.92.1:9991",
        "http://123.10.69.1:9901",
        "http://123.10.70.1:9901",
        "http://123.10.71.1:9901",
        "http://123.101.144.1:9901",
        "http://123.101.98.1:9898",
        "http://123.12.148.1:9901",
        "http://123.129.70.1:9901",
        "http://123.13.28.1:9901",
        "http://123.13.29.1:9901",
        "http://123.13.57.1:9901",
        "http://123.13.60.1:9901",
        "http://123.13.80.1:9901",
        "http://123.13.83.1:9901",
        "http://123.130.84.1:8154",
        "http://123.131.200.1:9901",
        "http://123.132.234.1:8154",
        "http://123.138.216.1:9902",
        "http://123.138.22.1:9901",
        "http://123.139.57.1:9901",
        "http://123.149.160.1:9901",
        "http://123.149.163.1:9901",
        "http://123.154.154.1:9901",
        "http://123.154.155.1:9901",
        "http://123.154.157.1:9901",
        "http://123.163.94.1:9901",
        "http://123.182.209.1:8088",
        "http://123.182.211.1:8088",
        "http://123.182.212.1:9901",
        "http://123.182.247.1:4433",
        "http://123.183.24.1:6666",
        "http://123.183.25.1:6666",
        "http://123.183.27.1:6666",
        "http://123.189.36.1:9901",
        "http://123.235.8.1:9901",
        "http://123.4.125.1:9901",
        "http://123.52.12.1:9901",
        "http://123.54.171.1:9901",
        "http://123.54.220.1:9901",
        "http://123.55.3.1:9901",
        "http://123.7.110.1:9901",
        "http://123.9.47.1:9901",
        "http://124.238.110.1:9999",
        "http://124.66.82.1:9901",
        "http://124.90.211.1:9901",
        "http://124.94.193.1:9902",
        "http://125.106.86.1:9901",
        "http://125.107.177.1:9901",
        "http://125.107.97.1:9901",
        "http://125.114.210.1:9901",
        "http://125.114.241.1:9901",
        "http://125.115.210.1:9901",
        "http://125.119.48.1:9901",
        "http://125.125.129.1:9901",
        "http://125.125.133.1:9901",
        "http://125.125.134.1:9901",
        "http://125.125.225.1:9901",
        "http://125.125.233.1:9901",
        "http://125.125.234.1:9901",
        "http://125.125.236.1:9901",
        "http://125.32.120.1:9901",
        "http://125.42.148.1:9901",
        "http://125.42.150.1:9901",
        "http://125.42.151.1:9901",
        "http://125.43.240.1:9901",
        "http://125.43.244.1:9901",
        "http://125.43.247.1:9901",
        "http://125.43.249.1:9901",
        "http://14.212.185.1:9901",
        "http://14.216.204.1:8883",
        "http://14.216.215.1:8883",
        "http://14.216.218.1:8883",
        "http://14.216.220.1:8883",
        "http://14.216.221.1:8883",
        "http://14.216.227.1:8883",
        "http://14.29.76.1:9901",
        "http://144.52.160.1:9901",
        "http://144.52.162.1:9901",
        "http://150.255.145.1:9901",
        "http://150.255.149.1:9901",
        "http://150.255.150.1:9901",
        "http://150.255.157.1:9901",
        "http://150.255.216.1:9901",
        "http://153.0.204.1:9901",
        "http://163.177.122.1:9901",
        "http://171.104.198.1:8181",
        "http://171.106.217.1:8181",
        "http://171.108.239.1:8181",
        "http://171.109.208.1:8099",
        "http://171.109.6.1:8181",
        "http://171.12.164.1:9901",
        "http://171.12.189.1:9901",
        "http://171.14.89.1:9901",
        "http://171.35.124.1:10011",
        "http://171.38.194.1:8082",
        "http://171.8.75.1:8011",
        "http://180.113.102.1:5000",
        "http://180.117.149.1:9901",
        "http://180.124.146.1:60000",
        "http://180.175.163.1:7777",
        "http://180.213.174.1:9901",
        "http://182.112.188.1:9901",
        "http://182.112.28.1:9901",
        "http://182.113.201.1:9901",
        "http://182.113.206.1:9901",
        "http://182.113.6.1:9901",
        "http://182.114.185.1:9901",
        "http://182.114.212.1:9901",
        "http://182.114.214.1:9901",
        "http://182.114.215.1:9901",
        "http://182.114.48.1:9901",
        "http://182.114.49.1:9901",
        "http://182.114.50.1:9901",
        "http://182.117.136.1:9901",
        "http://182.117.90.1:9901",
        "http://182.120.229.1:9901",
        "http://182.122.122.1:9901",
        "http://182.122.73.1:10086",
        "http://182.125.172.1:9901",
        "http://182.126.114.1:9901",
        "http://183.10.180.1:9901",
        "http://183.10.181.1:9901",
        "http://183.131.246.1:9901",
        "http://183.136.148.1:9901",
        "http://183.203.147.1:9901",
        "http://183.203.151.1:9901",
        "http://183.238.113.1:8883",
        "http://183.239.226.1:9901",
        "http://183.24.48.1:9901",
        "http://183.255.41.1:9901",
        "http://183.63.15.1:9901",
        "http://183.94.146.1:2222",
        "http://202.100.46.1:9901",
        "http://202.168.187.1:2024",
        "http://202.168.187.1:9999",
        "http://210.22.75.1:9901",
        "http://211.142.224.1:2023",
        "http://218.13.170.1:9901",
        "http://218.29.147.1:9901",
        "http://218.71.245.1:9901",
        "http://218.74.169.1:9901",
        "http://218.74.171.1:9901",
        "http://218.75.241.1:9901",
        "http://218.76.32.1:9901",
        "http://218.77.81.1:9901",
        "http://218.87.237.1:9901",
        "http://220.161.206.1:9901",
        "http://220.163.178.1:8888",
        "http://220.164.192.1:50085",
        "http://220.179.68.1:9901",
        "http://220.180.109.1:9901",
        "http://220.180.109.1:9902",
        "http://220.180.112.1:9901",
        "http://220.180.229.1:9901",
        "http://220.202.98.1:14901",
        "http://220.248.173.1:9901",
        "http://221.205.131.1:9999",
        "http://221.206.104.1:9901",
        "http://221.213.69.1:9901",
        "http://221.213.94.1:9901",
        "http://221.224.4.1:1111",
        "http://221.224.72.1:9901",
        "http://221.225.236.1:9901",
        "http://221.226.4.1:9901",
        "http://221.226.8.1:9527",
        "http://221.233.192.1:1111",
        "http://221.7.239.1:8181",
        "http://221.9.97.1:9901",
        "http://222.134.245.1:9901",
        "http://222.136.68.1:9901",
        "http://222.138.109.1:9901",
        "http://222.140.9.1:9901",
        "http://222.142.198.1:9901",
        "http://222.142.72.1:9901",
        "http://222.142.73.1:9901",
        "http://222.142.93.1:9901",
        "http://222.169.70.1:9901",
        "http://222.92.7.1:3334",
        "http://223.151.51.1:9901",
        "http://223.159.11.1:8099",
        "http://223.159.8.1:8099",
        "http://223.159.9.1:8099",
        "http://223.166.234.1:7777",
        "http://223.199.83.1:9901",
        "http://223.241.247.1:9901",
        "http://223.243.10.1:9008",
        "http://223.243.2.1:9008",
        "http://223.68.201.1:9901",
        "http://36.249.150.1:9901",
        "http://36.249.151.1:9901",
        "http://36.34.58.1:9901",
        "http://36.35.220.1:9901",
        "http://36.35.223.1:9901",
        "http://36.40.236.1:9999",
        "http://36.44.157.1:9901",
        "http://36.44.159.1:9901",
        "http://36.49.56.1:9901",
        "http://36.99.134.1:9901",
        "http://36.99.206.1:9901",
        "http://39.152.171.1:9901",
        "http://39.164.202.1:8899",
        "http://39.164.222.1:888",
        "http://39.165.44.1:9901",
        "http://39.74.142.1:9999",
        "http://42.225.203.1:9901",
        "http://42.225.222.1:9901",
        "http://42.235.4.1:9901",
        "http://42.237.248.1:9901",
        "http://42.237.26.1:9901",
        "http://58.20.77.1:9002",
        "http://58.209.101.1:9901",
        "http://58.210.23.1:9901",
        "http://58.210.60.1:9901",
        "http://58.216.229.1:9901",
        "http://58.218.184.1:9901",
        "http://58.220.219.1:1099",
        "http://58.220.219.1:9901",
        "http://58.23.26.1:9901",
        "http://58.23.27.1:9901",
        "http://58.242.103.1:9901",
        "http://58.243.224.1:9901",
        "http://58.243.234.1:9901",
        "http://58.243.33.1:9901",
        "http://58.243.93.1:9901",
        "http://58.245.97.1:9901",
        "http://58.245.99.1:9901",
        "http://58.48.37.1:1111",
        "http://58.48.5.1:1111",
        "http://58.51.111.1:1111",
        "http://58.51.111.1:9901",
        "http://58.53.152.1:9901",
        "http://58.53.153.1:9901",
        "http://58.53.154.1:9901",
        "http://58.53.155.1:9901",
        "http://58.57.155.1:9901",
        "http://58.57.21.1:9901",
        "http://58.57.40.1:9901",
        "http://59.173.183.1:9901",
        "http://59.173.243.1:9901",
        "http://60.187.74.1:9901",
        "http://60.190.18.1:9901",
        "http://60.209.232.1:9901",
        "http://60.213.92.1:9901",
        "http://60.217.73.1:83",
        "http://60.255.137.1:9901",
        "http://60.255.47.1:8801",
        "http://60.255.47.1:9901",
        "http://60.4.9.1:9901",
        "http://61.130.72.1:8888",
        "http://61.136.172.1:9901",
        "http://61.136.67.1:50085",
        "http://61.138.128.1:19901",
    ]

CHANNEL_CATEGORIES = {
    "å¤®è§†é¢‘é“": [
        "CCTV1", "CCTV2", "CCTV3", "CCTV4", "CCTV4æ¬§æ´²", "CCTV4ç¾æ´²", "CCTV5", "CCTV5+", "CCTV6", "CCTV7",
        "CCTV8", "CCTV9", "CCTV10", "CCTV11", "CCTV12", "CCTV13", "CCTV14", "CCTV15", "CCTV16", "CCTV17", "CCTV4K", "CCTV8K",
        "å…µå™¨ç§‘æŠ€", "é£äº‘éŸ³ä¹", "é£äº‘è¶³çƒ", "é£äº‘å‰§åœº", "æ€€æ—§å‰§åœº", "ç¬¬ä¸€å‰§åœº", "å¥³æ€§æ—¶å°š", "ä¸–ç•Œåœ°ç†", "å¤®è§†å°çƒ", "é«˜å°”å¤«ç½‘çƒ",
        "å¤®è§†æ–‡åŒ–ç²¾å“", "å«ç”Ÿå¥åº·", "ç”µè§†æŒ‡å—", "ä¸­å­¦ç”Ÿ", "å‘ç°ä¹‹æ—…", "ä¹¦æ³•é¢‘é“", "å›½å­¦é¢‘é“", "ç¯çƒå¥‡è§‚"
    ],
    "å«è§†é¢‘é“": [
        "æ¹–å—å«è§†", "æµ™æ±Ÿå«è§†", "æ±Ÿè‹å«è§†", "ä¸œæ–¹å«è§†", "æ·±åœ³å«è§†", "åŒ—äº¬å«è§†", "å¹¿ä¸œå«è§†", "å¹¿è¥¿å«è§†", "ä¸œå—å«è§†", "æµ·å—å«è§†",
        "æ²³åŒ—å«è§†", "æ²³å—å«è§†", "æ¹–åŒ—å«è§†", "æ±Ÿè¥¿å«è§†", "å››å·å«è§†", "é‡åº†å«è§†", "è´µå·å«è§†", "äº‘å—å«è§†", "å¤©æ´¥å«è§†", "å®‰å¾½å«è§†",
        "å±±ä¸œå«è§†", "è¾½å®å«è§†", "é»‘é¾™æ±Ÿå«è§†", "å‰æ—å«è§†", "å†…è’™å¤å«è§†", "å®å¤å«è§†", "å±±è¥¿å«è§†", "é™•è¥¿å«è§†", "ç”˜è‚ƒå«è§†", "é’æµ·å«è§†",
        "æ–°ç–†å«è§†", "è¥¿è—å«è§†", "ä¸‰æ²™å«è§†", "å…µå›¢å«è§†", "å»¶è¾¹å«è§†", "å®‰å¤šå«è§†", "åº·å·´å«è§†", "å†œæ—å«è§†", "å±±ä¸œæ•™è‚²å«è§†",
        "ä¸­å›½æ•™è‚²1å°", "ä¸­å›½æ•™è‚²2å°", "ä¸­å›½æ•™è‚²3å°", "ä¸­å›½æ•™è‚²4å°", "æ—©æœŸæ•™è‚²"
    ],
    "æ•°å­—é¢‘é“": [
        "CHCåŠ¨ä½œç”µå½±", "CHCå®¶åº­å½±é™¢", "CHCå½±è¿·ç”µå½±", "æ·˜ç”µå½±", "æ·˜ç²¾å½©", "æ·˜å‰§åœº", "æ·˜4K", "æ·˜å¨±ä¹", "æ·˜BABY", "æ·˜èŒå® ", "é‡æ¸©ç»å…¸",
        "æ˜Ÿç©ºå«è§†", "CHANNEL[V]", "å‡¤å‡°å«è§†ä¸­æ–‡å°", "å‡¤å‡°å«è§†èµ„è®¯å°", "å‡¤å‡°å«è§†é¦™æ¸¯å°", "å‡¤å‡°å«è§†ç”µå½±å°", "æ±‚ç´¢çºªå½•", "æ±‚ç´¢ç§‘å­¦",
        "æ±‚ç´¢ç”Ÿæ´»", "æ±‚ç´¢åŠ¨ç‰©", "çºªå®äººæ–‡", "é‡‘é¹°çºªå®", "çºªå®ç§‘æ•™", "ç›å½©é’å°‘", "ç›å½©ç«æŠ€", "ç›å½©ç¯®çƒ", "ç›å½©å¹¿åœºèˆ", "é­…åŠ›è¶³çƒ", "äº”æ˜Ÿä½“è‚²",
        "åŠ²çˆ†ä½“è‚²", "å¿«ä¹å‚é’“", "èŒ¶é¢‘é“", "å…ˆé”‹ä¹’ç¾½", "å¤©å…ƒå›´æ£‹", "æ±½æ‘©", "æ¢¨å›­é¢‘é“", "æ–‡ç‰©å®åº“", "æ­¦æœ¯ä¸–ç•Œ", "å“’å•µèµ›äº‹", "å“’å•µç”µç«", "é»‘è“ç”µå½±", "é»‘è“åŠ¨ç”»", 
        "ä¹æ¸¸", "ç”Ÿæ´»æ—¶å°š", "éƒ½å¸‚å‰§åœº", "æ¬¢ç¬‘å‰§åœº", "æ¸¸æˆé£äº‘", "é‡‘è‰²å­¦å ‚", "åŠ¨æ¼«ç§€åœº", "æ–°åŠ¨æ¼«", "å¡é…·å°‘å„¿", "é‡‘é¹°å¡é€š", "ä¼˜æ¼«å¡é€š", "å“ˆå“ˆç‚«åŠ¨", "å˜‰ä½³å¡é€š", 
        "ä¸­å›½äº¤é€š", "ä¸­å›½å¤©æ°”"
    ],
}

CHANNEL_MAPPING = {
    "CCTV1": ["CCTV-1", "CCTV-1 HD", "CCTV1 HD", "CCTV-1ç»¼åˆ", "CCTV1HD", "cctv1HD", "CCTV-1HD", "cctv-1HD"],
    "CCTV2": ["CCTV-2", "CCTV-2 HD", "CCTV2 HD", "CCTV-2è´¢ç»", "CCTV2HD", "cctv2HD", "CCTV-2HD", "cctv-2HD"],
    "CCTV3": ["CCTV-3", "CCTV-3 HD", "CCTV3 HD", "CCTV-3ç»¼è‰º", "CCTV3HD", "cctv3HD", "CCTV-3HD", "cctv-3HD"],
    "CCTV4": ["CCTV-4", "CCTV-4 HD", "CCTV4 HD", "CCTV-4ä¸­æ–‡å›½é™…", "CCTV4HD", "cctv4HD", "CCTV-4HD", "cctv-4HD"],
    "CCTV4æ¬§æ´²": ["CCTV-4æ¬§æ´²", "CCTV-4æ¬§æ´²", "CCTV4æ¬§æ´² HD", "CCTV-4 æ¬§æ´²", "CCTV-4ä¸­æ–‡å›½é™…æ¬§æ´²", "CCTV4ä¸­æ–‡æ¬§æ´²", "CCTV4æ¬§æ´²HD", "cctv4æ¬§æ´²HD", "CCTV-4æ¬§æ´²HD", "cctv-4æ¬§æ´²HD"],
    "CCTV4ç¾æ´²": ["CCTV-4ç¾æ´²", "CCTV-4åŒ—ç¾", "CCTV4ç¾æ´² HD", "CCTV-4 ç¾æ´²", "CCTV-4ä¸­æ–‡å›½é™…ç¾æ´²", "CCTV4ä¸­æ–‡ç¾æ´²", "CCTV4ç¾æ´²HD", "cctv4ç¾æ´²HD", "CCTV-4ç¾æ´²HD", "cctv-4ç¾æ´²HD"],
    "CCTV5": ["CCTV-5", "CCTV-5 HD", "CCTV5 HD", "CCTV-5ä½“è‚²", "CCTV5HD", "cctv5HD", "CCTV-5HD", "cctv-5HD"],
    "CCTV5+": ["CCTV-5+", "CCTV-5+ HD", "CCTV5+ HD", "CCTV-5+ä½“è‚²èµ›äº‹", "CCTV5+HD", "cctv5+HD", "CCTV-5+HD", "cctv-5+HD", "CCTV5plas"],
    "CCTV6": ["CCTV-6", "CCTV-6 HD", "CCTV6 HD", "CCTV-6ç”µå½±", "CCTV6HD", "cctv6HD", "CCTV-6HD", "cctv-6HD"],
    "CCTV7": ["CCTV-7", "CCTV-7 HD", "CCTV7 HD", "CCTV-7å›½é˜²å†›äº‹", "CCTV7HD", "cctv7HD", "CCTV-7HD", "cctv-7HD"],
    "CCTV8": ["CCTV-8", "CCTV-8 HD", "CCTV8 HD", "CCTV-8ç”µè§†å‰§", "CCTV8HD", "cctv8HD", "CCTV-8HD", "cctv-8HD"],
    "CCTV9": ["CCTV-9", "CCTV-9 HD", "CCTV9 HD", "CCTV-9çºªå½•", "CCTV9HD", "cctv9HD", "CCTV-9HD", "cctv-9HD"],
    "CCTV10": ["CCTV-10", "CCTV-10 HD", "CCTV10 HD", "CCTV-10ç§‘æ•™", "CCTV10HD", "cctv10HD", "CCTV-10HD", "cctv-10HD"],
    "CCTV11": ["CCTV-11", "CCTV-11 HD", "CCTV11 HD", "CCTV-11æˆæ›²", "CCTV11HD", "cctv11HD", "CCTV-11HD", "cctv-11HD"],
    "CCTV12": ["CCTV-12", "CCTV-12 HD", "CCTV12 HD", "CCTV-12ç¤¾ä¼šä¸æ³•", "CCTV12HD", "cctv12HD", "CCTV-12HD", "cctv-12HD"],
    "CCTV13": ["CCTV-13", "CCTV-13 HD", "CCTV13 HD", "CCTV-13æ–°é—»", "CCTV13HD", "cctv13HD", "CCTV-13HD", "cctv-13HD"],
    "CCTV14": ["CCTV-14", "CCTV-14 HD", "CCTV14 HD", "CCTV-14å°‘å„¿", "CCTV14HD", "cctv14HD", "CCTV-14HD", "cctv-14HD"],
    "CCTV15": ["CCTV-15", "CCTV-15 HD", "CCTV15 HD", "CCTV-15éŸ³ä¹", "CCTV15HD", "cctv15HD", "CCTV-15HD", "cctv-15HD"],
    "CCTV16": ["CCTV-16", "CCTV-16 HD", "CCTV-16 4K", "CCTV-16å¥¥æ—åŒ¹å…‹", "CCTV16 4K", "CCTV-16å¥¥æ—åŒ¹å…‹4K", "CCTV16HD", "cctv16HD", "CCTV-16HD", "cctv-16HD"],
    "CCTV17": ["CCTV-17", "CCTV-17 HD", "CCTV17 HD", "CCTV-17å†œä¸šå†œæ‘", "CCTV17HD", "cctv17HD", "CCTV-17HD", "cctv-17HD"],
    "CCTV4K": ["CCTV4Kè¶…é«˜æ¸…", "CCTV-4Kè¶…é«˜æ¸…", "CCTV-4K è¶…é«˜æ¸…", "CCTV 4K"],
    "CCTV8K": ["CCTV8Kè¶…é«˜æ¸…", "CCTV-8Kè¶…é«˜æ¸…", "CCTV-8K è¶…é«˜æ¸…", "CCTV 8K"],
    "å…µå™¨ç§‘æŠ€": ["CCTV-å…µå™¨ç§‘æŠ€", "CCTVå…µå™¨ç§‘æŠ€"],
    "é£äº‘éŸ³ä¹": ["CCTV-é£äº‘éŸ³ä¹", "CCTVé£äº‘éŸ³ä¹"],
    "ç¬¬ä¸€å‰§åœº": ["CCTV-ç¬¬ä¸€å‰§åœº", "CCTVç¬¬ä¸€å‰§åœº"],
    "é£äº‘è¶³çƒ": ["CCTV-é£äº‘è¶³çƒ", "CCTVé£äº‘è¶³çƒ"],
    "é£äº‘å‰§åœº": ["CCTV-é£äº‘å‰§åœº", "CCTVé£äº‘å‰§åœº"],
    "æ€€æ—§å‰§åœº": ["CCTV-æ€€æ—§å‰§åœº", "CCTVæ€€æ—§å‰§åœº"],
    "å¥³æ€§æ—¶å°š": ["CCTV-å¥³æ€§æ—¶å°š", "CCTVå¥³æ€§æ—¶å°š"],
    "ä¸–ç•Œåœ°ç†": ["CCTV-ä¸–ç•Œåœ°ç†", "CCTVä¸–ç•Œåœ°ç†"],
    "å¤®è§†å°çƒ": ["CCTV-å¤®è§†å°çƒ", "CCTVå¤®è§†å°çƒ"],
    "é«˜å°”å¤«ç½‘çƒ": ["CCTV-é«˜å°”å¤«ç½‘çƒ", "CCTVé«˜å°”å¤«ç½‘çƒ", "CCTVå¤®è§†é«˜ç½‘", "CCTV-é«˜å°”å¤«Â·ç½‘çƒ", "å¤®è§†é«˜ç½‘"],
    "å¤®è§†æ–‡åŒ–ç²¾å“": ["CCTV-å¤®è§†æ–‡åŒ–ç²¾å“", "CCTVå¤®è§†æ–‡åŒ–ç²¾å“", "CCTVæ–‡åŒ–ç²¾å“", "CCTV-æ–‡åŒ–ç²¾å“", "æ–‡åŒ–ç²¾å“"],
    "å«ç”Ÿå¥åº·": ["CCTV-å«ç”Ÿå¥åº·", "CCTVå«ç”Ÿå¥åº·"],
    "ç”µè§†æŒ‡å—": ["CCTV-ç”µè§†æŒ‡å—", "CCTVç”µè§†æŒ‡å—"],
    "å†œæ—å«è§†": ["é™•è¥¿å†œæ—å«è§†"],
    "ä¸‰æ²™å«è§†": ["æµ·å—ä¸‰æ²™å«è§†"],
    "å…µå›¢å«è§†": ["æ–°ç–†å…µå›¢å«è§†"],
    "å»¶è¾¹å«è§†": ["å‰æ—å»¶è¾¹å«è§†"],
    "å®‰å¤šå«è§†": ["é’æµ·å®‰å¤šå«è§†"],
    "åº·å·´å«è§†": ["å››å·åº·å·´å«è§†"],
    "å±±ä¸œæ•™è‚²å«è§†": ["å±±ä¸œæ•™è‚²"],
    "ä¸­å›½æ•™è‚²1å°": ["CETV1", "ä¸­å›½æ•™è‚²ä¸€å°", "ä¸­å›½æ•™è‚²1", "CETV-1 ç»¼åˆæ•™è‚²", "CETV-1"],
    "ä¸­å›½æ•™è‚²2å°": ["CETV2", "ä¸­å›½æ•™è‚²äºŒå°", "ä¸­å›½æ•™è‚²2", "CETV-2 ç©ºä¸­è¯¾å ‚", "CETV-2"],
    "ä¸­å›½æ•™è‚²3å°": ["CETV3", "ä¸­å›½æ•™è‚²ä¸‰å°", "ä¸­å›½æ•™è‚²3", "CETV-3 æ•™è‚²æœåŠ¡", "CETV-3"],
    "ä¸­å›½æ•™è‚²4å°": ["CETV4", "ä¸­å›½æ•™è‚²å››å°", "ä¸­å›½æ•™è‚²4", "CETV-4 èŒä¸šæ•™è‚²", "CETV-4"],
    "æ—©æœŸæ•™è‚²": ["ä¸­å›½æ•™è‚²5å°", "ä¸­å›½æ•™è‚²äº”å°", "CETVæ—©æœŸæ•™è‚²", "åç”µæ—©æœŸæ•™è‚²", "CETV æ—©æœŸæ•™è‚²"],
    "æ¹–å—å«è§†": ["æ¹–å—å«è§†4K"],
    "åŒ—äº¬å«è§†": ["åŒ—äº¬å«è§†4K"],
    "ä¸œæ–¹å«è§†": ["ä¸œæ–¹å«è§†4K"],
    "å¹¿ä¸œå«è§†": ["å¹¿ä¸œå«è§†4K"],
    "æ·±åœ³å«è§†": ["æ·±åœ³å«è§†4K"],
    "å±±ä¸œå«è§†": ["å±±ä¸œå«è§†4K"],
    "å››å·å«è§†": ["å››å·å«è§†4K"],
    "æµ™æ±Ÿå«è§†": ["æµ™æ±Ÿå«è§†4K"],
    "CHCå½±è¿·ç”µå½±": ["CHCé«˜æ¸…ç”µå½±", "CHC-å½±è¿·ç”µå½±", "å½±è¿·ç”µå½±", "chcé«˜æ¸…ç”µå½±"],
    "æ·˜ç”µå½±": ["IPTVæ·˜ç”µå½±", "åŒ—äº¬IPTVæ·˜ç”µå½±", "åŒ—äº¬æ·˜ç”µå½±"],
    "æ·˜ç²¾å½©": ["IPTVæ·˜ç²¾å½©", "åŒ—äº¬IPTVæ·˜ç²¾å½©", "åŒ—äº¬æ·˜ç²¾å½©"],
    "æ·˜å‰§åœº": ["IPTVæ·˜å‰§åœº", "åŒ—äº¬IPTVæ·˜å‰§åœº", "åŒ—äº¬æ·˜å‰§åœº"],
    "æ·˜4K": ["IPTVæ·˜4K", "åŒ—äº¬IPTV4Kè¶…æ¸…", "åŒ—äº¬æ·˜4K", "æ·˜4K", "æ·˜ 4K"],
    "æ·˜å¨±ä¹": ["IPTVæ·˜å¨±ä¹", "åŒ—äº¬IPTVæ·˜å¨±ä¹", "åŒ—äº¬æ·˜å¨±ä¹"],
    "æ·˜BABY": ["IPTVæ·˜BABY", "åŒ—äº¬IPTVæ·˜BABY", "åŒ—äº¬æ·˜BABY", "IPTVæ·˜baby", "åŒ—äº¬IPTVæ·˜baby", "åŒ—äº¬æ·˜baby"],
    "æ·˜èŒå® ": ["IPTVæ·˜èŒå® ", "åŒ—äº¬IPTVèŒå® TV", "åŒ—äº¬æ·˜èŒå® "],
    "é­…åŠ›è¶³çƒ": ["ä¸Šæµ·é­…åŠ›è¶³çƒ"],
    "ç›å½©é’å°‘": ["ç›å½©ç¾½æ¯›çƒ"],
    "æ±‚ç´¢çºªå½•": ["æ±‚ç´¢è®°å½•", "æ±‚ç´¢çºªå½•4K", "æ±‚ç´¢è®°å½•4K", "æ±‚ç´¢çºªå½• 4K", "æ±‚ç´¢è®°å½• 4K"],
    "é‡‘é¹°çºªå®": ["æ¹–å—é‡‘é¹°çºªå®", "é‡‘é¹°è®°å®"],
    "çºªå®ç§‘æ•™": ["åŒ—äº¬çºªå®ç§‘æ•™", "BRTVçºªå®ç§‘æ•™", "çºªå®ç§‘æ•™8K"],
    "æ˜Ÿç©ºå«è§†": ["æ˜Ÿç©ºè¡›è¦–", "æ˜Ÿç©ºè¡›è§†", "æ˜Ÿç©ºå«è¦–"],
    "CHANNEL[V]": ["CHANNEL-V", "Channel[V]"],
    "å‡¤å‡°å«è§†ä¸­æ–‡å°": ["å‡¤å‡°ä¸­æ–‡", "å‡¤å‡°ä¸­æ–‡å°", "å‡¤å‡°å«è§†ä¸­æ–‡", "å‡¤å‡°å«è§†"],
    "å‡¤å‡°å«è§†é¦™æ¸¯å°": ["å‡¤å‡°é¦™æ¸¯å°", "å‡¤å‡°å«è§†é¦™æ¸¯", "å‡¤å‡°é¦™æ¸¯"],
    "å‡¤å‡°å«è§†èµ„è®¯å°": ["å‡¤å‡°èµ„è®¯", "å‡¤å‡°èµ„è®¯å°", "å‡¤å‡°å’¨è¯¢", "å‡¤å‡°å’¨è¯¢å°", "å‡¤å‡°å«è§†å’¨è¯¢å°", "å‡¤å‡°å«è§†èµ„è®¯", "å‡¤å‡°å«è§†å’¨è¯¢"],
    "å‡¤å‡°å«è§†ç”µå½±å°": ["å‡¤å‡°ç”µå½±", "å‡¤å‡°ç”µå½±å°", "å‡¤å‡°å«è§†ç”µå½±", "é³³å‡°è¡›è¦–é›»å½±å°", " å‡¤å‡°ç”µå½±"],
    "èŒ¶é¢‘é“": ["æ¹–å—èŒ¶é¢‘é“"],
    "å¿«ä¹å‚é’“": ["æ¹–å—å¿«ä¹å‚é’“"],
    "å…ˆé”‹ä¹’ç¾½": ["æ¹–å—å…ˆé”‹ä¹’ç¾½"],
    "å¤©å…ƒå›´æ£‹": ["å¤©å…ƒå›´æ£‹é¢‘é“"],
    "æ±½æ‘©": ["é‡åº†æ±½æ‘©", "æ±½æ‘©é¢‘é“", "é‡åº†æ±½æ‘©é¢‘é“"],
    "æ¢¨å›­é¢‘é“": ["æ²³å—æ¢¨å›­é¢‘é“", "æ¢¨å›­", "æ²³å—æ¢¨å›­"],
    "æ–‡ç‰©å®åº“": ["æ²³å—æ–‡ç‰©å®åº“"],
    "æ­¦æœ¯ä¸–ç•Œ": ["æ²³å—æ­¦æœ¯ä¸–ç•Œ"],
    "ä¹æ¸¸": ["ä¹æ¸¸é¢‘é“", "ä¸Šæµ·ä¹æ¸¸é¢‘é“", "ä¹æ¸¸çºªå®", "SiTVä¹æ¸¸é¢‘é“", "SiTV ä¹æ¸¸é¢‘é“"],
    "æ¬¢ç¬‘å‰§åœº": ["ä¸Šæµ·æ¬¢ç¬‘å‰§åœº4K", "æ¬¢ç¬‘å‰§åœº 4K", "æ¬¢ç¬‘å‰§åœº4K", "ä¸Šæµ·æ¬¢ç¬‘å‰§åœº"],
    "ç”Ÿæ´»æ—¶å°š": ["ç”Ÿæ´»æ—¶å°š4K", "SiTVç”Ÿæ´»æ—¶å°š", "ä¸Šæµ·ç”Ÿæ´»æ—¶å°š"],
    "éƒ½å¸‚å‰§åœº": ["éƒ½å¸‚å‰§åœº4K", "SiTVéƒ½å¸‚å‰§åœº", "ä¸Šæµ·éƒ½å¸‚å‰§åœº"],
    "æ¸¸æˆé£äº‘": ["æ¸¸æˆé£äº‘4K", "SiTVæ¸¸æˆé£äº‘", "ä¸Šæµ·æ¸¸æˆé£äº‘"],
    "é‡‘è‰²å­¦å ‚": ["é‡‘è‰²å­¦å ‚4K", "SiTVé‡‘è‰²å­¦å ‚", "ä¸Šæµ·é‡‘è‰²å­¦å ‚"],
    "åŠ¨æ¼«ç§€åœº": ["åŠ¨æ¼«ç§€åœº4K", "SiTVåŠ¨æ¼«ç§€åœº", "ä¸Šæµ·åŠ¨æ¼«ç§€åœº"],
    "å¡é…·å°‘å„¿": ["åŒ—äº¬KAKUå°‘å„¿", "BRTVå¡é…·å°‘å„¿", "åŒ—äº¬å¡é…·å°‘å„¿", "å¡é…·åŠ¨ç”»"],
    "å“ˆå“ˆç‚«åŠ¨": ["ç‚«åŠ¨å¡é€š", "ä¸Šæµ·å“ˆå“ˆç‚«åŠ¨"],
    "ä¼˜æ¼«å¡é€š": ["æ±Ÿè‹ä¼˜æ¼«å¡é€š", "ä¼˜æ¼«æ¼«ç”»"],
    "é‡‘é¹°å¡é€š": ["æ¹–å—é‡‘é¹°å¡é€š"],
    "ä¸­å›½äº¤é€š": ["ä¸­å›½äº¤é€šé¢‘é“"],
    "ä¸­å›½å¤©æ°”": ["ä¸­å›½å¤©æ°”é¢‘é“"],
    # å…¶ä»–å¯æŒ‰éœ€æ·»åŠ 
}

RESULTS_PER_CHANNEL = 5  # æ¯ä¸ªé¢‘é“ä¿ç•™æºæ•°
# ==============================================

async def generate_urls(url):
    modified_urls = []
    ip_start = url.find("//")+2
    ip_end = url.find(":", ip_start)
    base = url[:ip_start]
    ip_prefix = url[ip_start:ip_end].rsplit('.',1)[0]
    port = url[ip_end:]
    for i in range(1,256):
        modified_urls.append(f"{base}{ip_prefix}.{i}{port}/iptv/live/1000.json?key=txiptv")
    return modified_urls

async def fetch_json(session, url, semaphore):
    async with semaphore:
        try:
            async with session.get(url, timeout=0.5) as resp:
                data = await resp.json()
                results = []
                for item in data.get('data', []):
                    name = item.get('name')
                    urlx = item.get('url')
                    if not name or not urlx or ',' in urlx:
                        continue
                    if not urlx.startswith("http"):
                        base = url.split("/iptv")[0]
                        urlx = base + urlx
                    for std_name, aliases in CHANNEL_MAPPING.items():
                        if name in aliases:
                            name = std_name
                            break
                    results.append((name,urlx))
                return results
        except:
            return []

async def check_url(session, url, semaphore):
    async with semaphore:
        try:
            async with session.get(url, timeout=0.5) as resp:
                if resp.status == 200:
                    return url
        except:
            return None

async def main():
    print("ğŸš€ å¼€å§‹è¿è¡Œ ITVlist è„šæœ¬")
    semaphore = asyncio.Semaphore(100)

    async with aiohttp.ClientSession() as session:

        all_urls = []
        for url in urls:
            modified_urls = await generate_urls(url)
            all_urls.extend(modified_urls)

        print(f"ğŸ” ç”Ÿæˆå¾…æ‰«æ URL å…±: {len(all_urls)} ä¸ª")

        print("â³ å¼€å§‹æ£€æµ‹å¯ç”¨ JSON API...")
        tasks = [check_url(session, u, semaphore) for u in all_urls]
        valid_urls = [r for r in await asyncio.gather(*tasks) if r]

        print(f"âœ… å¯ç”¨ JSON åœ°å€: {len(valid_urls)} ä¸ª")

        print("ğŸ“¥ å¼€å§‹æŠ“å–èŠ‚ç›®å• JSON...")
        tasks = [fetch_json(session, u, semaphore) for u in valid_urls]

        results = []
        fetched = await asyncio.gather(*tasks)

        for sublist in fetched:
            results.extend(sublist)

        print(f"ğŸ“º æŠ“åˆ°é¢‘é“æ€»æ•°: {len(results)} æ¡")

    final_results = [(name, url, 0) for name, url in results]

    itv_dict = {cat: [] for cat in CHANNEL_CATEGORIES}

    for name, url, speed in final_results:
        for cat, channels in CHANNEL_CATEGORIES.items():
            if name in channels:
                itv_dict[cat].append((name, url, speed))
                break

    for cat in CHANNEL_CATEGORIES:
        print(f"ğŸ“¦ åˆ†ç±»ã€Š{cat}ã€‹æ‰¾åˆ° {len(itv_dict[cat])} æ¡é¢‘é“")

    beijing_now = datetime.datetime.now(
        datetime.timezone(datetime.timedelta(hours=8))
    ).strftime("%Y-%m-%d %H:%M:%S")

    disclaimer_url = "https://kakaxi-1.asia/LOGO/Disclaimer.mp4"

    with open("itvlist.txt", 'w', encoding='utf-8') as f:
        f.write(f"æ›´æ–°æ—¶é—´: {beijing_now}ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰\n\n")
        f.write("æ›´æ–°æ—¶é—´,#genre#\n")
        f.write(f"{beijing_now},{disclaimer_url}\n\n")

        for cat in CHANNEL_CATEGORIES:
            f.write(f"{cat},#genre#\n")

            for ch in CHANNEL_CATEGORIES[cat]:
                ch_items = [x for x in itv_dict[cat] if x[0] == ch]
                ch_items = ch_items[:RESULTS_PER_CHANNEL]

                for item in ch_items:
                    f.write(f"{item[0]},{item[1]}\n")

    print("ğŸ‰ itvlist.txt å·²ç”Ÿæˆå®Œæˆï¼")

if __name__ == "__main__":
    asyncio.run(main())

